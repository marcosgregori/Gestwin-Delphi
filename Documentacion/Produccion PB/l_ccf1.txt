	Crystal Report Professional v14.0 (32-bit) - Report Definition

1.0 File Information

	Report File: 
	Version: 8.0

2.0 Record Sort Fields

3.0 Group Sort Fields

4.0 Formulas

4.1 Record Selection Formula
	

4.2 Group Selection Formula
	

4.3 Other Formulas

	Name: {@CabeceraEmpresa}
	Formula: {@Empresa_Codigo} + ' - '  + {@Empresa_Nombre} + ' - ' + ToText( {@Ejercicio},0 ) 

	Name: {@Usuario_Codigo}
	Formula: '02'

	Name: {@Informe_Titulo}
	Formula: ''

	Name: {@TituloClaseA}
	Formula: ''

	Name: {@TituloClaseB}
	Formula: ''

	Name: {@TituloClaseC}
	Formula: ''

	Name: {@TextoLimites}
	Formula: ': desde el código de artículo [' + {@CodigoInicial} + '] hasta el [' + {@CodigoFinal} +']'

	Name: {@TextoSeleccion}
	Formula: ': unidades a fabricar ' +  ToText( {@Cantidad}, 0 ) + '.';

	Name: {@ObtenNivelBase}
	Formula: WhilePrintingRecords;
	BooleanVar PrecioValido;
	
	PrecioValido := True;
	NumberVar NivelBase;
	
	NivelBase := {Report1.ValorEntero3};
	NivelBase;

	Name: {@ResetCosteFabricacion}
	Formula: WhilePrintingRecords;
	
	NumberVar CosteFabricacion;
	
	CosteFabricacion := 0.0;

	Name: {@CosteTotal}
	Formula: NumberVar CosteFabricacion;
	
	Sum ({@PrecioCosteConjunto}, {Report1.CodigoEntero}) + CosteFabricacion;
	
	
	
	

	Name: {@CosteFabricacion}
	Formula: WhilePrintingRecords;
	
	NumberVar CosteFabricacion;
	
	CosteFabricacion;

	Name: {@CodigoComponente}
	Formula: WhilePrintingRecords;
	
	NumberVar Offset;
	NumberVar NivelBase;
	StringVar    TextoCodigo;
	BooleanVar PrecioValido;
	
	Offset            := {Report1.ValorEntero3} - NivelBase;
	TextoCodigo := {Report1.ValorTexto1};
	If      Offset>5
	then ( TextoCodigo := '* ' + TextoCodigo; Offset := 5 );
	If      Offset>0
	then TextoCodigo := ReplicateString ('   ',Offset ) + TextoCodigo;
	
	If     {Report1.ValorEntero3}<>0
	then ( If     {Report1.ValorEntero2}=1                   // Es un componente
	          then(  If      {Report1.Logico1}
	                    then PrecioValido := False; )
	          else If   {Report1.ValorNumerico1}=0
	                 then  PrecioValido := False;                // Es una operacion
	       );
	
	TextoCodigo;
	
	

	Name: {@DescripcionComponente}
	Formula: WhilePrintingRecords;
	
	NumberVar Offset;
	NumberVar NivelBase;
	StringVar    TextoCodigo
	;
	Offset            := {Report1.ValorEntero3} - NivelBase;
	TextoCodigo := {Report1.Descripcion1};
	If      Offset>5
	then Offset := 5;
	If      Offset>0
	then TextoCodigo := ReplicateString ('   ',Offset ) + TextoCodigo;
	
	TextoCodigo;
	

	Name: {@PrecioCosteConjunto}
	Formula: {Report1.ValorNumerico1} * {Report1.ValorNumerico3}

	Name: {@CodigoComponente}
	Formula: WhilePrintingRecords;
	
	NumberVar Offset;
	NumberVar NivelBase;
	StringVar    TextoCodigo;
	BooleanVar PrecioValido;
	
	Offset            := {Report1.ValorEntero3} - NivelBase;
	TextoCodigo := {Report1.ValorTexto1};
	If      Offset>5
	then ( TextoCodigo := '* ' + TextoCodigo; Offset := 5 );
	If      Offset>0
	then TextoCodigo := ReplicateString ('   ',Offset ) + TextoCodigo;
	
	If     {Report1.ValorEntero3}<>0
	then ( If     {Report1.ValorEntero2}=1                   // Es un componente
	          then(  If      {Report1.Logico1}
	                    then PrecioValido := False; )
	          else If   {Report1.ValorNumerico1}=0
	                 then  PrecioValido := False;                // Es una operacion
	       );
	
	TextoCodigo;
	
	

	Name: {@DescripcionComponente}
	Formula: WhilePrintingRecords;
	
	NumberVar Offset;
	NumberVar NivelBase;
	StringVar    TextoCodigo
	;
	Offset            := {Report1.ValorEntero3} - NivelBase;
	TextoCodigo := {Report1.Descripcion1};
	If      Offset>5
	then Offset := 5;
	If      Offset>0
	then TextoCodigo := ReplicateString ('   ',Offset ) + TextoCodigo;
	
	TextoCodigo;
	

	Name: {@AcumulaCosteFabricacion}
	Formula: WhilePrintingRecords;
	
	NumberVar CosteFabricacion;
	
	If	({Report1.valorEntero3}=0) or ({Report1.ValorEntero2}=0)
	then	CosteFabricacion := CosteFabricacion + {Report1.ValorNumerico1};
	
	CosteFabricacion;

5.0 Sectional Information

5.1 Page Header Section
	Visible

	Coste
		String, Visible, Left Alignment, Top Alignment, 
		Keep Together



	{@CabeceraEmpresa}
		String, Visible, Default Alignment, Top Alignment, 
		Keep Together


	PrintDate
		Date, Visible, Right Alignment, Top Alignment, 
		Keep Together, Windows Default Type: Use Windows Short Date, Date Order: Day Month Year, Year Type: Long, Month Type: Long Month Name, Day Type: Numeric Day, Leading Day Type: None, First Separator: ' de ', Second Separator: ' de ', Leading Day Separator: ''


	{@Usuario_Codigo}
		String, Visible, Default Alignment, Top Alignment, 
		Keep Together


	Código
		String, Visible, Left Alignment, Top Alignment, 
		Keep Together



	Descripción
		String, Visible, Left Alignment, Top Alignment, 
		Keep Together



	{@Informe_Titulo}
		String, Visible, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, Word Wrap


	Cantidad
		String, Visible, Left Alignment, Top Alignment, 
		Keep Together



	Coste
		String, Visible, Left Alignment, Top Alignment, 
		Keep Together



	DataTime
		Time, Visible, Default Alignment, Top Alignment, 
		Keep Together, Time Base: 24 Hour, AM/PM Type: AM/PM After, Hour Type: Numeric, Minute Type: Numeric, Second Type: None, AM String: 'AM', PM String: 'PM', Hour Minute Separator: ':', Minute  Second Separator: ':'


	Coste unitario
		String, Visible, Left Alignment, Top Alignment, 
		Keep Together



	Fabricación
		String, Visible, Left Alignment, Top Alignment, 
		Keep Together



	Componentes
		String, Visible, Left Alignment, Top Alignment, 
		Keep Together



	{@TituloClaseA}
		String, Visible, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, Word Wrap


	{@TituloClaseB}
		String, Visible, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, Word Wrap


	{@TituloClaseC}
		String, Visible, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, Word Wrap


5.2 Page Footer Section
	Visible, New Page After, Keep Together, Print At Bottom of Page

	GESTWIN
		String, Visible, Left Alignment, Top Alignment, 
		Keep Together



	Página
		String, Visible, Left Alignment, Top Alignment, 
		Keep Together



	PageNumber
		Numeric, Visible, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, 
		Leading Minus, 0 Decimal Places, Rounding: 1, 
		Thousands Symbol: '.', Decimal Symbol: ','


5.3 Report Header Section
	Visible, New Page Before

	Criterios
		String, Visible, Left Alignment, Top Alignment, 
		Keep Together



	Límites
		String, Visible, Left Alignment, Top Alignment, 
		Keep Together



	{@TextoLimites}
		String, Visible, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, Word Wrap


	{@TextoSeleccion}
		String, Visible, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, Word Wrap


	Selección
		String, Visible, Left Alignment, Top Alignment, 
		Keep Together



5.4 Report Footer Section
	Hidden, New Page After

5.5 Group Header Section #1
	Visible

	{@ObtenNivelBase}
		Numeric, Hidden, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, 
		Leading Minus, 2 Decimal Places, Rounding: 0.01, 
		Thousands Symbol: '.', Decimal Symbol: ','


	Numeric Format Formulas -
		 Decimal Places: {@DecCantidadCompra}
		Rounding Type: {@DecCantidadCompra}
		
	{Report1.CodigoTexto}
		String, Visible, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, Word Wrap


	{Report1.Descripcion2}
		String, Visible, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, Word Wrap


	{Report1.ValorTexto3}
		String, Visible, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, Word Wrap


	{Report1.ValorTexto4}
		String, Visible, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, Word Wrap


	{Report1.ValorTexto5}
		String, Visible, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, Word Wrap


	{@ResetCosteFabricacion}
		Numeric, Hidden, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, 
		Leading Minus, 2 Decimal Places, Rounding: 0.01, 
		Thousands Symbol: '.', Decimal Symbol: ','


5.6 Group Footer Section #1
	Visible

	Sum ({@PrecioCosteConjunto}, {Report1.CodigoEntero})
		Numeric, Visible, Default Alignment, Top Alignment, 
		Keep Together, 
		Leading Minus, 0 Decimal Places, Rounding: 1, 
		Thousands Symbol: ',', Decimal Symbol: '.'


	{@CosteTotal}
		Numeric, Visible, Default Alignment, Top Alignment, 
		Keep Together, 
		Leading Minus, 0 Decimal Places, Rounding: 1, 
		Thousands Symbol: '.', Decimal Symbol: ','


		Font Color Formulas -
		WhilePrintingRecords;

BooleanVar PrecioValido;

If      not PrecioValido
then  Red
		
	Coste total ...
		String, Visible, Left Alignment, Top Alignment, 
		Keep Together



	Costes de fabricación y de los componentes ...
		String, Visible, Left Alignment, Top Alignment, 
		Keep Together, Expand



	{@CosteFabricacion}
		Numeric, Visible, Default Alignment, Top Alignment, 
		Keep Together, 
		Leading Minus, 0 Decimal Places, Rounding: 1, 
		Thousands Symbol: '.', Decimal Symbol: ','


5.7 Group Header Section #2
	Visible

	{Report1.ValorEntero1}
		Numeric, Visible, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, 
		Leading Minus, 0 Decimal Places, Rounding: 1, 
		Thousands Symbol: '.', Decimal Symbol: ','


5.8 Group Footer Section #2
	Visible

	Sum ({@PrecioCosteConjunto}, {Report1.ValorEntero1})
		Numeric, Visible, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, 
		Leading Minus, 2 Decimal Places, Rounding: 0.01, 
		Thousands Symbol: '.', Decimal Symbol: ','


	Numeric Format Formulas -
		 Decimal Places: {@DecPrecioCompra}
		Rounding Type: {@DecPrecioCompra}
		
5.9 Group Header Section #3
	Hidden

5.10 Group Footer Section #3
	Hidden

5.11 Details Section
	Visible

	Subsection.1 
		Visible, Suppress Blank Sections

		Format Formulas

		Visible: ({Report1.valorEntero3}=0) or ({Report1.ValorEntero2}=0)
		
	Subsection.2 
		Visible, Keep Together

		Format Formulas

		Visible: ({Report1.valorEntero3}=0) or ({Report1.ValorEntero2}=1)
		
	{Report1.ValorNumerico1}
		Numeric, Visible, Default Alignment, Top Alignment, 
		Keep Together, Suppress If Zero, 
		Leading Minus, 0 Decimal Places, Rounding: 1, 
		Thousands Symbol: ',', Decimal Symbol: '.'


	Numeric Format Formulas -
		 Decimal Places: {@DecCantidadCompra}
		Rounding Type: {@DecCantidadCompra}
		
		Font Color Formulas -
		If   {Report1.Logico1}
then Red
		
	{@CodigoComponente}
		String, Visible, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, Word Wrap


		Font Color Formulas -
		If   {Report1.Logico1}
then Red
		
	{@DescripcionComponente}
		String, Visible, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, Word Wrap


		Font Color Formulas -
		If   {Report1.Logico1}
then Red
		
	{@PrecioCosteConjunto}
		Numeric, Visible, Default Alignment, Top Alignment, 
		Keep Together, Suppress If Zero, 
		Leading Minus, 2 Decimal Places, Rounding: 0.01, 
		Thousands Symbol: '.', Decimal Symbol: ','


	Numeric Format Formulas -
		 Decimal Places: {@DecPrecioCompra}
		Rounding Type: {@DecPrecioCompra}
		
		Font Color Formulas -
		If   {Report1.Logico1}
then Red
		
	{Report1.ValorNumerico3}
		Numeric, Visible, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, Suppress If Zero, 
		Leading Minus, 2 Decimal Places, Rounding: 0.01, 
		Thousands Symbol: '.', Decimal Symbol: ','


	Numeric Format Formulas -
		 Decimal Places: {@DecPrecioCompra}
		Rounding Type: {@DecPrecioCompra}
		
		Font Color Formulas -
		If   {Report1.Logico1}
then Red
		
	{Report1.ValorTexto3}
		String, Visible, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, Word Wrap


		Font Color Formulas -
		If   {Report1.Logico1}
then Red
		
	{Report1.ValorTexto4}
		String, Visible, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, Word Wrap


		Font Color Formulas -
		If   {Report1.Logico1}
then Red
		
	{Report1.ValorTexto5}
		String, Visible, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, Word Wrap


		Font Color Formulas -
		If   {Report1.Logico1}
then Red
		
	{@CodigoComponente}
		String, Visible, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, Word Wrap


		Font Color Formulas -
		If   {Report1.ValorNumerico1}=0
then Red
else Gray
		
	{Report1.ValorNumerico1}
		Numeric, Visible, Default Alignment, Top Alignment, 
		Keep Together, 
		Leading Minus, 0 Decimal Places, Rounding: 1, 
		Thousands Symbol: '.', Decimal Symbol: ','


		Font Color Formulas -
		If   {Report1.ValorNumerico1}=0
then Red
		
	{@DescripcionComponente}
		String, Visible, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, Word Wrap


		Font Color Formulas -
		If   {Report1.ValorNumerico1}=0
then Red
else Gray
		
	{@AcumulaCosteFabricacion}
		Numeric, Hidden, Default Alignment, Top Alignment, 
		Keep Together, Using System Default Formatting, 
		Leading Minus, 2 Decimal Places, Rounding: 0.01, 
		Thousands Symbol: '.', Decimal Symbol: ','


